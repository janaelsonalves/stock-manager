<!--
  Generated template for the StockFormPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar text-center hideBackButton="false">
    <ion-title>Adding Stock</ion-title>
  </ion-navbar>

</ion-header>


<!-- <ion-content padding>

  <form [formGroup]="stockForm" (ngSubmit)="addStock()">
    <ion-item>
      <ion-label stacked>Papel/Código: </ion-label>
      <ion-input type="text" formControlName="symbol"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label stacked>Quantidade: </ion-label>
      <ion-input type="number" formControlName="quantity"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label stacked>Preço: </ion-label>
      <ion-input type="number" formControlName="price"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label stacked>Emolumentos: </ion-label>
      <ion-input type="number" formControlName="fees"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label stacked>Liquidação: </ion-label>
      <ion-input type="number" formControlName="sale_fee"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label stacked>ISS: </ion-label>
      <ion-input type="number" formControlName="iss"></ion-input>
    </ion-item>


    <ion-item>
      <ion-label stacked>Total: {{total}}</ion-label>
    </ion-item>

    <div padding>
      <button type="submit" ion-button icon-end full round [disabled]="!stockForm.valid">
        Add
        <ion-icon name="add"></ion-icon>
      </button>
    </div>
  </form>

</ion-content> -->

<ion-content padding>
  <form [formGroup]="stockForm" (ngSubmit)="addStock()">

    <ion-item>
      <ion-label stacked>Trading: </ion-label>
      <ion-select formControlName="trading">
        <ion-option value="purchase">Purchase</ion-option>
        <ion-option value="sale">Sale</ion-option>
      </ion-select>
    </ion-item>

    <ion-item>
      <ion-label stacked>Symbol: </ion-label>
      <ion-input type="search" placeholder="ABCD4" formControlName="symbol" (keyup)="onKey($event)"></ion-input>
    </ion-item>
    <div *ngIf="!(stockForm.get('symbol').untouched || stockForm.get('symbol').value)" class="error">
      Symbol is required
    </div>

    <ion-list class="filtered-tocks" *ngIf="filteredStocks" no-lines>
      <ion-item *ngFor="let stock of filteredStocks" (click)="selectStock($event, stock)">
        {{stock['1. symbol']}}
      </ion-item>
    </ion-list>

    <ion-item>
      <ion-label stacked>Date: </ion-label>
      <ion-datetime placeholder="DD/MM/YYYY" displayFormat="DD/MM/YYYY" pickerFormat="DD MMMM YYYY" formControlName="createdAt"></ion-datetime>
    </ion-item>
    <div *ngIf="!(stockForm.get('createdAt').untouched || stockForm.get('createdAt').value)" class="error">
      Date is required
    </div>

    <ion-item>
      <ion-label stacked>Quantity: </ion-label>
      <ion-input type="number" placeholder="100" formControlName="quantity"></ion-input>
    </ion-item>
    <div *ngIf="!(stockForm.get('quantity').untouched || stockForm.get('quantity').value)" class="error">
      Quantity is required
    </div>

    <ion-item>
      <ion-label stacked>Price: </ion-label>
      <ion-input type="number" step="0.01" placeholder="0.00" formControlName="price"></ion-input>
    </ion-item>
    <div *ngIf="!(stockForm.get('price').untouched || stockForm.get('price').value)" class="error">
      Price is required
    </div>

    <ion-item>
      <ion-label stacked>Brokerage: </ion-label>
      <ion-input type="number" step="0.01" placeholder="0.00" formControlName="brokerage"></ion-input>
    </ion-item>
    <div *ngIf="!(stockForm.get('brokerage').untouched || stockForm.get('brokerage').value)" class="error">
      Brokerage is required
    </div>

    <ion-item>
      <ion-label stacked>Others Fees: </ion-label>
      <ion-input type="number" step="0.01" placeholder="0.00" formControlName="others_fees"></ion-input>
    </ion-item>

    <ion-item *ngIf="getLiquidValue()" no-lines>
      <p><strong>Total Expenses: </strong>{{getTotalExpenses()}}</p>
      <p><strong>Liquid Value: </strong>{{getLiquidValue()}}</p>
    </ion-item>

    <div padding>
      <button ion-button full round type="submit">
        Add
        <ion-icon name="add"></ion-icon>
      </button>
    </div>
  </form>
</ion-content>